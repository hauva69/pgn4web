<html> 
 
<!--
  pgn4web javascript chessboard
  copyright (C) 2009, 2010 Paolo Casaschi
  see README file and http://pgn4web.casaschi.net
  for credits, license and more details
--> 
 
<head> 
 
<title>pgn4web multiple live chessboards</title> 
 
<link rel="shortcut icon" href="pawn.ico" /> 

<script src="pgn4web.js" type="text/javascript"></script>
 
<script type="text/javascript"> 
 
  pgnFile_default = location.protocol + "//" + location.hostname + location.pathname.replace(/\/[^\/]*$/, "/live/live.pgn");
  
  // accepts pgnData as alias for pgnFile for consistency with board.html
  if ((pgnFile = gup("pgnData")) === "") { 
    if ((pgnFile = gup("pgnFile")) === "") {
      pgnFile = pgnFile_default; 
    }
  }
 
  if ((refreshMinutes = gup("refreshMinutes")) === "") { 
    refreshMinutes = 1;
  } else {
    testMinutes = refreshMinutes + "";
    if (testMinutes.match(/[^0-9\.]/)) {
      alert("ERROR: refreshMinutes parameter must be a positive number.\n" +
            "Supplied " + testMinutes + "; defaulting to 1."); 
      refreshMinutes = 1;
    }
  }

  if ((initialGameNumber = gup("initialGame")) === "") { 
    initialGameNumber = 1;
  } else {
    testGameNumber = initialGameNumber + "";
    if (testGameNumber.match(/[^0-9-]/)) {
      alert("ERROR: initialGame parameter must be an integer.\n" +
            "Supplied " + initialGameNumber + "; defaulting to 1."); 
      initialGameNumber = 1;
    }
  }

  if ((gup("help") == "true") || (gup("help") == "t")) { developer_help(); }
 
function gup( name ){
 
  name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
  var regexS = "[\\?&]"+name+"=([^&#]*)";
  // commented below to match first occurrence (to avoid users overruling setting)
  // regexS = regexS+"(?!.*"+regexS+")"; // matches the LAST occurrence
  var regex = new RegExp( regexS, "i" );
  var results = regex.exec( window.location.href );
  if( results !== null ) { return decodeURIComponent(results[1]); }
 
  // allows for short version of the URL parameters, for instance sC matches squareColor
  compact_name = name.charAt(0);
    for(i=1; i<name.length; i++){
      if (name.charAt(i).match(/[A-Z]/)) { compact_name = compact_name + name.charAt(i).toLowerCase(); }
    }
  name = compact_name;
 
  name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
  regexS = "[\\?&]"+name+"=([^&#]*)";
  // commented below to match first occurrence (to avoid users overruling setting)
  // regexS = regexS+"(?!.*"+regexS+")"; // matches the LAST occurrence
  regex = new RegExp( regexS, "i" );
 
  results = regex.exec( window.location.href );
  if( results !== null ) { return decodeURIComponent(results[1]); }
 
  return "";
}
 
function developer_help() {
  alert("pgn4web live-multi-frame.html parameters" + "\n" + 
        " - pgnData = " + pgnFile + "; PGN file to load (default " + pgnFile_default + ")" + "\n" +
        " - refreshMinutes = " + refreshMinutes + "; refresh interval in minutes, decimals allowed (default 1)" + "\n" +
        " - help = true; prints this help (default false)");
}
 
  SetPgnUrl(pgnFile);
  SetImagePath("uscf/20");
  SetImageType("png");
  SetHighlightOption(true); // true or false
  SetAutoplayDelay(1000); // milliseconds
  SetAutostartAutoplay(false);
  SetAutoplayNextGame(false); 
  SetInitialGame(initialGameNumber);
  SetInitialHalfmove("end", true);
  SetShortcutKeysEnabled(false);
  SetLiveBroadcast(refreshMinutes, false, false, true);

  clearShortcutSquares("CDEFGH", "2");
  clearShortcutSquares("ABCDEFGH", "345");
  clearShortcutSquares("CDEF", "6");
  clearShortcutSquares("BC", "7");
  clearShortcutSquares("G", "7");

function addTagToTitle(tagLabel, tagValue, object) {
  if (!tagValue || tagValue[1] == "?" || !object) { return; }
  object.title += "  \n " + tagLabel + tagValue;
}

function customFunctionOnPgnGameLoad() {
  wObject = document.getElementById("GameWhite");
  bObject = document.getElementById("GameBlack");
  if (wObject && bObject) {
    if ((wObject.innerHTML === "") && (bObject.innerHTML !== "")) { wObject.innerHTML = "-"; }
    if ((bObject.innerHTML === "") && (wObject.innerHTML !== "")) { bObject.innerHTML = "-"; }
  }
  if (theObject = document.getElementById("bottomContainer")) {
    theObject.title = " game " + (currentGame+1) + " of " + numberOfGames;
    addTagToTitle("event:", gameEvent[currentGame], theObject);
    addTagToTitle("site:", gameSite[currentGame], theObject);
    addTagToTitle("date:", gameDate[currentGame], theObject);
    addTagToTitle("round:", gameRound[currentGame], theObject);
    addTagToTitle("white:", gameWhite[currentGame], theObject);
    addTagToTitle("black:", gameBlack[currentGame], theObject);
    addTagToTitle("result:", gameResult[currentGame], theObject);
    addTagToTitle("termination:", customPgnHeaderTag("Termination"), theObject);
    addTagToTitle("timecontrol:", customPgnHeaderTag("TimeControl"), theObject);
  }
}

function customFunctionOnMove() {
  wObject = document.getElementById("GameWhiteClock");
  bObject = document.getElementById("GameBlackClock");
  if (wObject && bObject) {
    if ((wObject.innerHTML === "") && (bObject.innerHTML !== "")) { wObject.innerHTML = "-"; }
    if ((bObject.innerHTML === "") && (wObject.innerHTML !== "")) { bObject.innerHTML = "-"; }
  }
}

</script>

<style type="text/css"> 
 
body {
  background: white; 
  color: #214398; 
  font-family: sans-serif; 
  font-size: 11px;
  font-weight: bold;
  padding: 13px;
}

.boardTable {
  border-style: double; 
  border-color: #C2C9D1;
  border-width: 3px;
  box-shadow: 0px 0px 13px #C2C9D1;
  -webkit-box-shadow: 0px 0px 13px #C2C9D1;
  -moz-box-shadow: 0px 0px 13px #C2C9D1;
  width: 214px;
  height: 214px;
}

.pieceImage {
  width: 20;
  height: 20;
}

.whiteSquare,
.blackSquare,
.highlightWhiteSquare,
.highlightBlackSquare {
  width: 26;
  height: 26;
  border-style: solid;
  border-width: 1;
}

.whiteSquare,
.highlightWhiteSquare {
  border-color: #E8E8E8;
  background: #E8E8E8;
}

.blackSquare,
.highlightBlackSquare {
  border-color: #C2C9D1;
  background: #C2C9D1;
}

.highlightWhiteSquare,
.highlightBlackSquare {
  border-color: #8888FF;
}

.move {
}

.bottomContainer { 
  width: 214px;
  margin-top: 10px;
}

.leftHeaderItem,
.rightHeaderItem {
  white-space: nowrap;
  overflow: hidden;
  width: 102px;
}

.leftHeaderItem {
  float: left;
  text-align: left;
}

.rightHeaderItem {
  float: right;
  text-align: right;
}

</style>

</head>

<body>

<!-- paste your PGN below and make sure you dont specify an external source with SetPgnUrl() -->
<form style="display: none;"><textarea style="display: none;" id="pgnText">

</textarea></form>
<!-- paste your PGN above and make sure you dont specify an external source with SetPgnUrl() -->

<center>

<div id="GameBoard"></div>

<div id="bottomContainer" class="bottomContainer">

<div class="leftHeaderItem"><span id="GameLastMove"></span>&nbsp;</div>
<div class="rightHeaderItem">&nbsp;<span id="GameResult"></span></div>

<div class="leftHeaderItem"><span id="GameWhite"></span>&nbsp;</div>
<div class="rightHeaderItem">&nbsp;<span id="GameBlack"></span></div>

<div class="leftHeaderItem"><span id="GameWhiteClock"></span>&nbsp;</div>
<div class="rightHeaderItem">&nbsp;<span id="GameBlackClock"></span></div>

</div>

</center>

</body>

</html>
 
