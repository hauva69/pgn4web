<html>

<!--
  pgn4web javascript chessboard
  copyright (C) 2009, 2012 Paolo Casaschi
  see README file and http://pgn4web.casaschi.net
  for credits, license and more details
-->

<head>

<title>dynamic frame test</title>

<link rel="shortcut icon" href="pawn.ico" />

<style type="text/css">

span {
  white-space:nowrap;
}

input {
  height:20px;
  font-size:10px;
}

</style>

</head>

<body style="margin:0; padding:0; overflow-x:hidden; overflow-y:hidden; font-size:10px; font-family:sans-serif;" onload="atLoad();">

<center>

<div style="padding:10px;" id="header">
<span>&nbsp; width <input id="width" style="width:6em;" type="number" onchange="change_w(this.value);"> &nbsp;</span>
<span>&nbsp; height <input id="height" style="width:6em;" type="number" onchange="change_h(this.value);"> &nbsp;</span>
<span>&nbsp; <input type="button" value="swap" onclick="swap_wh();"/> &nbsp;</span>
<span>&nbsp;&nbsp;</span>
<span>&nbsp; <input type="button" value="16:9" onclick="preselect(16,9);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="9:16" onclick="preselect(9,16);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="4:3" onclick="preselect(4,3);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="3:4" onclick="preselect(3,4);"/> &nbsp;</span>
<span>&nbsp;&nbsp;</span>
<span>&nbsp; <input type="button" value="narrower" onclick="modify(1/1.05, 1);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="wider" onclick="modify(1.05, 1);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="shorter" onclick="modify(1, 1/1.05);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="taller" onclick="modify(1, 1.05);"/> &nbsp;</span>
<span>&nbsp;&nbsp;</span>
<span>&nbsp; <input type="button" value="poke" onclick="modify(0, 0);"/>&nbsp;</span>
<span>&nbsp;&nbsp;</span>
<span>&nbsp; <input type="button" value="refresh" onclick="frameRefresh();"/> &nbsp;</span>
</div>

<iframe id="frame" src="" height="" width="" style="margin:10px;" frameborder="no" scrolling='no' marginheight='0' marginwidth='0'></iframe>

</center>

<script type="text/javascript">

minBoardSize = 200;

try {
  document.getElementById("width").min = minBoardSize;
  document.getElementById("height").min = minBoardSize;
} catch (e) {}

function atLoad() {
  preselect(16, 9);
  frameRefresh();
}

function frameRefresh() {
  document.getElementById("frame").src = "dynamic-frame.html" + location.search;
}

function preselect(w, h) {
  if (window.innerWidth && window.innerHeight) { ww = window.innerWidth; wh = window.innerHeight; }
  else if (document.documentElement && document.documentElement.clientWidth) { ww = document.documentElement.clientWidth; wh = document.documentElement.clientHeight; }
  else if (document.body && document.body.clientWidth) { ww = document.body.clientWidth; wh = document.body.clientHeight; }
  else { throw("failed to get window size"); }
  aw = ww - 20;
  ah = wh - document.getElementById("header").offsetHeight - 20;
  fw = Math.floor(Math.min(aw, ah * w / h));
  fh = Math.floor(fw * h / w);
  change_w(fw); 
  change_h(fh); 
}

function change_w(w) {
  if (isNaN(w) || (w < minBoardSize)) { w = document.getElementById("width").value = minBoardSize; }
  document.getElementById("frame").width = w;
  if (w !== document.getElementById("width").value) { document.getElementById("width").value = w; }
}

function change_h(h) {
  if (isNaN(h) || (h < minBoardSize)) { h = document.getElementById("height").value = minBoardSize; }
  document.getElementById("frame").height = h;
  if (h !== document.getElementById("height").value) { document.getElementById("height").value = h; }
}

function modify(dw, dh) {
  if (dw == 0) { dw = (95 + 10 * Math.random()) / 100; }
  if (dh == 0) { dh = (95 + 10 * Math.random()) / 100; }
  if (dw != 1) { change_w(Math.round(document.getElementById("width").value * dw)); }
  if (dh != 1) { change_h(Math.round(document.getElementById("height").value * dh)); }
}

function swap_wh() {
  fw = document.getElementById("height").value;
  fh = document.getElementById("width").value;
  change_w(fw);
  change_h(fh);
}

</script>

</body>

</html>

