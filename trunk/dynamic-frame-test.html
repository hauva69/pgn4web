<html>

<!--
  pgn4web javascript chessboard
  copyright (C) 2009, 2012 Paolo Casaschi
  see README file and http://pgn4web.casaschi.net
  for credits, license and more details
-->

<head>

<title>dynamic frame test</title>

<link rel="shortcut icon" href="pawn.ico" />

<style type="text/css">

span {
  white-space:nowrap;
}

input {
  height:20px;
  font-size:10px;
}

</style>

</head>

<body style="margin:0; padding:0; overflow-x:auto; overflow-y:scroll; font-size:10px; font-family:sans-serif;" onload="atLoad();">

<center>

<div style="padding:10px;" id="header">
<span>&nbsp; width <input id="width" size="5" onchange="change_w(this.value);"> &nbsp;</span>
<span>&nbsp; height <input id="height" size="5" onchange="change_h(this.value);"> &nbsp;</span>
<span>&nbsp; <input type="button" value="swap" onclick="swap_wh();"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="16:9" onclick="preselect(16,9);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="9:16" onclick="preselect(9,16);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="4:3" onclick="preselect(4,3);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="3:4" onclick="preselect(3,4);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="-w-" onclick="modify(-10, 0);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="+W+" onclick="modify(+10, 0);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="-h-" onclick="modify(0, -10);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="+H+" onclick="modify(0 ,+10);"/> &nbsp;</span>
<span>&nbsp; <input type="button" value="random" onclick="modify(null, null);"/>&nbsp;</span>
<span>&nbsp; <input type="button" value="refresh" onclick="frameRefresh();"/> &nbsp;</span>
</div>

<iframe id="frame" src="" height="" width="" style="margin-bottom:10px;" frameborder="no" scrolling='no' marginheight='0' marginwidth='0'></iframe>

</center>

<script type="text/javascript">

function atLoad() {
  preselect(16, 9);
  frameRefresh();
}

function frameRefresh() {
  document.getElementById("frame").src = "dynamic-frame.html" + location.search;
}

function preselect(w, h) {
  if (window.innerWidth && window.innerHeight) { ww = window.innerWidth; wh = window.innerHeight; }
  else if (document.documentElement && document.documentElement.clientWidth) { ww = document.documentElement.clientWidth; wh = document.documentElement.clientHeight; }
  else if (document.body && document.body.clientWidth) { ww = document.body.clientWidth; wh = document.body.clientHeight; }
  else { throw("failed to get window size"); }
  aw = ww - 20;
  ah = wh - document.getElementById("header").offsetHeight - 10;
  fw = Math.floor(Math.min(aw, ah * w / h));
  fh = Math.floor(fw * h / w);
  change_w(fw); 
  change_h(fh); 
}

function change_w(w) {
  if (isNaN(w)) { w = document.getElementById("width").value = 256; }
  document.getElementById("frame").width = w;
  if (w !== document.getElementById("width").value) { document.getElementById("width").value = w; }
}

function change_h(h) {
  if (isNaN(h)) { h = document.getElementById("height").value = 256; }
  document.getElementById("frame").height = h;
  if (h !== document.getElementById("height").value) { document.getElementById("height").value = h; }
}

function modify(dw, dh) {
  if (dw === null) { dw = Math.floor(-15 + 30 * Math.random()); }
  if (dh === null) { dh = Math.floor(-15 + 30 * Math.random()); }
  if (dw != 0) { change_w(Math.floor(document.getElementById("width").value * (100 + dw) / 100)); }
  if (dh != 0) { change_h(Math.floor(document.getElementById("height").value * (100 + dh) / 100)); }
}

function swap_wh() {
  fw = document.getElementById("height").value;
  fh = document.getElementById("width").value;
  change_w(fw);
  change_h(fh);
}

</script>

</body>

</html>

