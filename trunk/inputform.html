<html>

<head>

<title>Basic PGN viewer form</title>

<link href="inputform.css" type="text/css" rel="stylesheet"></link>

<script src="pgn4web.js" type="text/javascript"></script>
<script>
// SetPgnUrl(""); // if set, this has precedence over the inline PGN below
   SetImagePath ("merida/24"); // use "" path if images are in the same folder as this javascript file
   SetImageType("png");
   SetHighlightOption(false) // true or false
// SetGameSelectorOptions("Select a game...", false, 0, 0, 0, 15, 15, 0, 10); // (head, num, chEvent, chSite, chRound, chWhite, chBlack, chResult, chDate);// SetCommentsIntoMoveText(true)
// SetCommentsOnSeparateLines(true)
   SetAutoplayDelay(2000); // milliseconds
// SetAutostartAutoplay(false);
// SetAutoplayNextGame(false); // if set, move to the next game at the end of the current game during autoplay
// SetInitialGame(1); // number of game to be shown at load, from 1 (default); if 0 a random game is loaded
// SetInitialHalfmove(0); // halfmove number to be shown at load, 0 for start position, -1 for random halfmove
   SetShortcutKeysEnabled(false);
</script>

</head>

<body>

<!-- paste your PGN below and make sure you dont specify an external source with SetPgnUrl() -->
<span style="display:none" id="pgnText">

</span>
<!-- paste your PGN above and make sure you dont specify an external source with SetPgnUrl() -->

<table id=chessboardTable cellspacing=0 cellpadding=0 border=0>

<tr>

<td width=230 valign=top align=left>
<div id="GameBoard"></div>
<br>
</td>

<td width=20>
</td>

<td valign=top align=left>
<span style="font-size: 14;"> 
Event: <span style="font-weight: bold;" id="GameEvent"></span><br>
Site: <span style="font-weight: bold;" id="GameSite"></span><br>
Round: <span style="font-weight: bold;" id="GameRound"></span><br>
Date: <span style="font-weight: bold;" id="GameDate"></span><br>
<br>
White: <span style="font-weight: bold;" id="GameWhite"></span><br>
Black: <span style="font-weight: bold;" id="GameBlack"></span><br>
Result: <span style="font-weight: bold;" id="GameResult"></span><br>
<br>
Last move: <span style="font-weight: bold" id="GameLastMove"></span><br>
Next move: <span style="font-weight: bold" id="GameNextMove"></span>
</span>
</td>

</tr>

<tr>

<td align=center valign=top>
<span id="GameButtons"></span>
<br>
</td>

<td width=20>
</td>

<td align=left valign=top>
<span id="GameSelector"></span>
<br>
</td>

</tr>

</table>

<form style="display:inline;">
<input id=pgnButton type=button value="show games from PGN text box" onClick="javascript: 
  document.getElementById('pgnText').innerHTML = document.getElementById('pgnForm').value;
  new_start_pgn4web(); 
">
<br>
<textarea id="pgnForm" rows=11 cols=80></textarea>
</form>

<script>

function new_start_pgn4web() {
  start_pgn4web();
  theObject = document.getElementById('GameSelSelect');
  if (theObject != null) theObject.style.width = document.getElementById('pgnForm').offsetWidth - 20 -230;
}

function gup( name ){
  name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
  var regexS = "[\\?&]"+name+"=([^&#]*)";  
  regexS = regexS+"(?!.*"+regexS+")"; // matches the LAST occurrence
  var regex = new RegExp( regexS );
  var results = regex.exec( window.location.href );
  if( results == null )    return "";
  else    return results[1];
} 

if ((newPgnText = gup("pgnText")) != "") {
  // remove URL escape chars such as %20 replaced by space
  newPgnText = unescape(newPgnText);
  // replaces the non-breaking-hyphen with a normal hyphen
  newPgnText = newPgnText.replace(/&#8209;/g,"-");

  // cleans the PGN text
  newPgnText = newPgnText.replace(/\[/g,"\n\n[");
  newPgnText = newPgnText.replace(/\]/g,"]\n\n");
  newPgnText = newPgnText.replace(/([012\*])([\s]*)(\[)/g,"$1\n\n$3");
  newPgnText = newPgnText.replace(/\]([\s]*)\[/g,"]\n[");
  newPgnText = newPgnText.replace(/^([\s]*)\[/g,"[");

  document.getElementById('pgnText').innerHTML = newPgnText;
  document.getElementById('pgnForm').value = newPgnText;

  window.onload = new_start_pgn4web;
}
document.getElementById('pgnButton').style.width = document.getElementById('pgnForm').offsetWidth;
document.getElementById('chessboardTable').style.width = document.getElementById('pgnForm').offsetWidth;

</script>

</body>

</html>



