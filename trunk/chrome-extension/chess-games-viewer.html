<html>

<!--
  pgn4web javascript chessboard
  copyright (C) 2009, 2010 Paolo Casaschi
  see README file and http://pgn4web.casaschi.net
  for credits, license and more details
-->

<head>

<title>chess games</title>

<link href="chess-games-viewer.css" type="text/css" rel="stylesheet" />

<link rel="shortcut icon" href="pawn.ico" />

<script src="pgn4web.js" type="text/javascript"></script>
<script type="text/javascript">

   thisRegExp = /(&|\?)(help|h)([^&$]*)(&|$)/i;
   if (window.location.search.match(thisRegExp) !== null) {
       alert("pgn4web collection.html parameters" + "\n" +
             " - pgnFile=filename.pgn" + "\n" +
	     " - search=search expression" + "\n" +
             " - refreshMinutes=live broadcast delay (default 0 = live broadcast disabled)" + "\n" +
             " - refreshDemo= if set true sets live demo mode (default false)" + "\n" +
             " - help");
   }

   pgnFilename = "";
   thisRegExp = /(&|\?)(pgnFile|pf)=([^&$]*)(&|$)/i;
   if (window.location.search.match(thisRegExp) !== null) {
       pgnFilename = unescape(window.location.search.match(thisRegExp)[3]);
   } else {
       // accepts pgnData as alias for pgnFile for consistency with board.html
       thisRegExp = /(&|\?)(pgnData|pd)=([^&$]*)(&|$)/i;
       if (window.location.search.match(thisRegExp) !== null) {
           pgnFilename = unescape(window.location.search.match(thisRegExp)[3]);
       }
   } 
   if (pgnFilename === "") {
       pgnTitle = "no PGN file loaded";
   } else {
       SetPgnUrl(pgnFilename); // if set, this has precedence over the inline PGN in the HTML file
       pgnTitle = pgnFilename;
   }

   thisRegExp = /(&|\?)(title|t)=([^&$]*)(&|$)/i;
   if (window.location.search.match(thisRegExp) !== null) {
       document.title = pgnTitle = unescape(window.location.search.match(thisRegExp)[3]);
   }

   SetImagePath("alpha/36"); // use "" path if images are in the same folder as this javascript file
   SetImageType("png");
   SetHighlightOption(true); // true or false
   SetGameSelectorOptions(" Event         Site          Rd  White            Black            Res  Date", true, 12, 12, 2, 15, 15, 3, 10); // (head, num, chEvent, chSite, chRound, chWhite, chBlack, chResult, chDate);   
   SetCommentsIntoMoveText(true);
   SetCommentsOnSeparateLines(false);
   SetAutoplayDelay(1000); // milliseconds
   SetAutostartAutoplay(false);
   SetAutoplayNextGame(false); // if set, move to the next game at the end of the current game during autoplay
   SetInitialHalfmove(0, true); // halfmove number to be shown at load, 0 for start position, -1 for random halfmove
   SetShortcutKeysEnabled(true);

   thisRegExp = /(&|\?)(search|s)=([^&$]*)(&|$)/i;
   if (window.location.search.match(thisRegExp) !== null) {
       SetInitialGame(unescape(window.location.search.match(thisRegExp)[3]));
   } else {
       SetInitialGame(1); // number of game to be shown at load, from 1 (default); values (keep the quotes) of "first", "last", "random" are accepted; other string values assumed as PGN search string
   }

   alertFlag = demoFlag = false;
   thisRegExp = /(&|\?)(refreshDemo|rd)=([^&$]*)(&|$)/i;
   if (window.location.search.match(thisRegExp) !== null) {
       refreshDemo = unescape(window.location.search.match(thisRegExp)[3]);
       if ((refreshDemo == "true") || (refreshDemo == "t")) { alertFlag = demoFlag = true; }
   }

   thisRegExp = /(&|\?)(refreshMinutes|rm)=([^&$]*)(&|$)/i;
   if (window.location.search.match(thisRegExp) !== null) {
       refreshMinutes = unescape(window.location.search.match(thisRegExp)[3]);
       SetInitialHalfmove("end", true); // halfmove number to be shown at load, 0 for start position, -1 for random halfmove
       SetLiveBroadcast(refreshMinutes, alertFlag, demoFlag); // set live broadcast; parameters are delay (refresh delay in minutes, 0 means no broadcast, default 0) alertFlag (if true, displays debug error messages, default false) demoFlag (if true starts broadcast demo mode, default false)
   }

  function customFunctionOnPgnGameLoad() {
    if (theObject = document.getElementById("GameRound")) {
      if (theObject.innerHTML) {
        theObject.innerHTML = "round " + theObject.innerHTML;
      }
    }
  }

</script>

</head>

<body>

<!-- paste your PGN below and make sure you dont specify an external source with SetPgnUrl() -->
<form style="display: none;"><textarea style="display: none;" id="pgnText">

</textarea></form>
<!-- paste your PGN above and make sure you dont specify an external source with SetPgnUrl() -->

<div id="GameSelector"></div>
<div id="GameSearch"></div>

<div class="columnsContainer">

<div class="boardColumn">
<center>
<div id="GameBoard"></div>
<div id="GameButtons"></div>
</center>
</div>

<div class="headerColumn">
<div class="headerItem">&nbsp;</div>
<div class="headerItem"><span class="innerHeaderItem" title="date" id="GameDate"></span>&nbsp;</div>
<div class="headerItem"><span class="innerHeaderItem" title="site" id="GameSite"></span>&nbsp;</div>
<div class="headerItem">&nbsp;</div>
<div class="headerItem"><span class="innerHeaderItem" title="event" id="GameEvent"></span>&nbsp;</div>
<div class="headerItem"><span class="innerHeaderItem" title="round" id="GameRound"></span>&nbsp;</div>
<div class="headerItem">&nbsp;</div>
<div class="headerItem"><span class="innerHeaderItem" title="white clock" id="GameWhiteClock"></span>&nbsp;</div>
<div class="headerItem"><span class="innerHeaderItem boldItem" title="white player" id="GameWhite"></span>&nbsp;</div>
<div class="headerItem"><span class="innerHeaderItem boldItem" title="black player" id="GameBlack"></span>&nbsp;</div>
<div class="headerItem"><span class="innerHeaderItem" title="black clock" id="GameBlackClock"></span>&nbsp;</div>
<div class="headerItem">&nbsp;</div>
<div class="headerItem"><span class="innerHeaderItem boldItem" title="result" id="GameResult"></span>&nbsp;</div>
<div class="headerItem">&nbsp;</div>
</div>

</div>

<div class="moveText" id="GameText"></div>

<div class="notes">
<div style="float: left; text-align: left;" id="GameLiveStatus"></div>
<div><script type="text/javascript">document.write(pgnFilename);</script></div>
</div>

</body>

</html>
